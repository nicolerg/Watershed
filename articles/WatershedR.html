<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>WatershedR • WatershedR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="WatershedR">
<meta property="og:description" content="WatershedR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">WatershedR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/WatershedR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nicolerg/WatershedR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>WatershedR</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/nicolerg/WatershedR/blob/HEAD/vignettes/WatershedR.Rmd" class="external-link"><code>vignettes/WatershedR.Rmd</code></a></small>
      <div class="hidden name"><code>WatershedR.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/nicolerg/WatershedR" class="external-link">WatershedR</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Watershed is an unsupervised probabilistic framework that integrates
genomic annotations and RNA-seq outlier calls to identify the
probability a rare variant has a functional effect on a particular
RNA-seq outlier phenotype (examples of outlier phenotypes can be, but
are not limited to total expression, splicing, or ASE). Watershed
extends our previous model <a href="https://www.nature.com/articles/nature24267" class="external-link">RIVER</a> (which can
also be run via this package) by incorporating information from multiple
outlier phenotypes into one model, where predictions for functional
effects in one outlier phenotype are informed by observed outlier calls
in another phenotype. Please see <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7646251/" class="external-link">our
publication in <em>Science</em></a> for more details.</p>
</div>
<div class="section level2">
<h2 id="input-data">Input data<a class="anchor" aria-label="anchor" href="#input-data"></a>
</h2>
<p>See <code><a href="../reference/evaluate_watershed.html">evaluate_watershed()</a></code> for details of the input file
format. For all the examples in this vignette, we will use the sample
input data provided here: <a href="https://raw.githubusercontent.com/BennyStrobes/Watershed/master/example_data/watershed_example_data.txt" class="external-link uri">https://raw.githubusercontent.com/BennyStrobes/Watershed/master/example_data/watershed_example_data.txt</a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For all examples, use example data that has 3 E outlier p-value columns,</span></span>
<span><span class="co"># which corresponds to number_of_dimensions = 3</span></span>
<span><span class="va">input</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/BennyStrobes/Watershed/"</span>,</span>
<span>     <span class="st">"master/example_data/watershed_example_data.txt"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="functions">Functions<a class="anchor" aria-label="anchor" href="#functions"></a>
</h2>
<p>This package provides two user-level functions:
<code><a href="../reference/evaluate_watershed.html">evaluate_watershed()</a></code> and <code><a href="../reference/predict_watershed.html">predict_watershed()</a></code>.
Here we provide examples of how to run each of these functions with the
recommended default parameters.</p>
<div class="section level3">
<h3 id="evaluate-watershed">Evaluate Watershed<a class="anchor" aria-label="anchor" href="#evaluate-watershed"></a>
</h3>
<p>This function is used to train a Watershed model on non-N2 pairs and
evaluate model on held-out N2-pairs. This allows the user to get an idea
of the accuracy of Watershed applied to their data.</p>
<div class="section level4">
<h4 id="evaluate-watershed-with-watershed_approximate-method">Evaluate Watershed with “Watershed_approximate” method<a class="anchor" aria-label="anchor" href="#evaluate-watershed-with-watershed_approximate-method"></a>
</h4>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="../reference/evaluate_watershed.html">evaluate_watershed</a></span><span class="op">(</span>input_file <span class="op">=</span> <span class="va">input</span>,</span>
<span>  model_name <span class="op">=</span> <span class="st">"Watershed_approximate"</span>,</span>
<span>  number_of_dimensions <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  output_prefix <span class="op">=</span> <span class="st">"~/watershed_approximate_n3"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="evaluate-watershed-with-watershed_exact-method">Evaluate Watershed with “Watershed_exact” method<a class="anchor" aria-label="anchor" href="#evaluate-watershed-with-watershed_exact-method"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="../reference/evaluate_watershed.html">evaluate_watershed</a></span><span class="op">(</span>input_file <span class="op">=</span> <span class="va">input</span>,</span>
<span>  model_name <span class="op">=</span> <span class="st">"Watershed_exact"</span>,</span>
<span>  number_of_dimensions <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  output_prefix <span class="op">=</span> <span class="st">"~/watershed_exact_n3"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="evaluate-watershed-with-river-method">Evaluate Watershed with “RIVER” method<a class="anchor" aria-label="anchor" href="#evaluate-watershed-with-river-method"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="../reference/evaluate_watershed.html">evaluate_watershed</a></span><span class="op">(</span>input_file <span class="op">=</span> <span class="va">input</span>,</span>
<span>  model_name <span class="op">=</span> <span class="st">"RIVER"</span>,</span>
<span>  number_of_dimensions <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  output_prefix <span class="op">=</span> <span class="st">"~/river_n3"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="predict-watershed">Predict Watershed<a class="anchor" aria-label="anchor" href="#predict-watershed"></a>
</h3>
<p>This function trains a Watershed model on training data and predicts
Watershed posterior probabilities (using Watershed parameters optimized
in training) on all gene-individual in a much larger prediction data
set.</p>
<div class="section level4">
<h4 id="predict-watershed-with-watershed_approximate-method">Predict Watershed with “Watershed_approximate” method<a class="anchor" aria-label="anchor" href="#predict-watershed-with-watershed_approximate-method"></a>
</h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/predict_watershed.html">predict_watershed</a></span><span class="op">(</span>training_input <span class="op">=</span> <span class="va">input</span>,</span>
<span>  prediction_input <span class="op">=</span> <span class="va">input</span>,</span>
<span>  model_name <span class="op">=</span> <span class="st">"Watershed_approximate"</span>,</span>
<span>  number_dimensions <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  output_prefix <span class="op">=</span> <span class="st">"~/watershed_approximate_n3"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="predict-watershed-with-watershed_exact-method">Predict Watershed with “Watershed_exact” method<a class="anchor" aria-label="anchor" href="#predict-watershed-with-watershed_exact-method"></a>
</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/predict_watershed.html">predict_watershed</a></span><span class="op">(</span>training_input <span class="op">=</span> <span class="va">input</span>,</span>
<span>  prediction_input <span class="op">=</span> <span class="va">input</span>,</span>
<span>  model_name <span class="op">=</span> <span class="st">"Watershed_exact"</span>,</span>
<span>  number_dimensions <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  output_prefix <span class="op">=</span> <span class="st">"~/watershed_exact_n3"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="predict-watershed-with-river-method">Predict Watershed with “RIVER” method<a class="anchor" aria-label="anchor" href="#predict-watershed-with-river-method"></a>
</h4>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/predict_watershed.html">predict_watershed</a></span><span class="op">(</span>training_input <span class="op">=</span> <span class="va">input</span>,</span>
<span>  prediction_input <span class="op">=</span> <span class="va">input</span>,</span>
<span>  model_name <span class="op">=</span> <span class="st">"RIVER"</span>,</span>
<span>  number_dimensions <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  output_prefix <span class="op">=</span> <span class="st">"~/river_n3"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Ben Strober, Nicole Gay.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
